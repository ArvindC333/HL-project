<html>
  <head>
<div class="tab">
  <button class="tablinks" onclick="openCity(event, 'Dashboard')"><A HREF="/Users/arvind/HLProject/index.html">Dashboard</A></button>
  <button class="tablinks" onclick="openCity(event, 'TimeSeries')"><A HREF="/Users/arvind/HLProject/timeseries.html">Time Series</A></button>
  <button class="tablinks" onclick="openCity(event, 'SheetsChart')"><A HREF="/Users/arvind/Desktop/ReportingDashboard/SheetsChart.html">Sheets Chart</A></button>
</div>

 <h1><font face="verdana" color="green">Yearly</font></h1>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});
             google.charts.load('current', {packages: ['table']});   

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawOne);
            google.charts.setOnLoadCallback(drawTwo);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
    function drawOne() {
      var queryString =  encodeURIComponent('where date ''2018-12'' < Year_Month')
      var magicIncantation = '/gviz/tq?sheet=Sheet1&headers=1&tq=';

      var query = new google.visualization.Query(
          'https://docs.google.com/spreadsheets/d/1CBtrfo3kJZW_y_xqrBg1gNXiJPcL_3h5MXvdoCf6kEM' + magicIncantation + queryString);
      query.send(handleSampleDataQueryResponse);
    }




    function handleSampleDataQueryResponse(response) {
      if (response.isError()) {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }
       var options = {title:'Service Requests Total',
                      subtitle:'Last 12 months',
                       width:1000,
                       height:400,
                       chartArea: {width: '90%'},
                       legend:{position: 'top', textStyle: {color: 'blue', fontSize: 8}}};

      var data1 = response.getDataTable();
      var chart1 = new google.visualization.ColumnChart(document.getElementById('chart_vid1'));
      chart1.draw(data1, options);


    
    }

    
       
    </script>
  </head>

 <body>
    <!--Table and divs that hold the pie charts-->
    <table class="columns">
      <tr>
        <td><div id="chart_vid1" style="border: 1px solid #ccc"></div></td>
      </tr>
    </table>
  </body>
</html>
      

